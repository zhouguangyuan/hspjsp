package com.hsp.utils;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.util.ArrayList;
import javax.crypto.spec.PSource;
import com.sun.org.apache.bcel.internal.generic.NEW;

public class SqlHelper {
	private Connection ct = null;
	private ResultSet rs = null;
	private PreparedStatement ps = null;

	public ArrayList executeQuery(String sql, String paras[]) {
		ArrayList al = new ArrayList();
		DBUtil dbu = new DBUtil();
		try {
			ct = dbu.getConn();
			ps = ct.prepareStatement(sql);
			for (int i = 0; i < paras.length; i++) {
				ps.setString(i + 1, paras[i]);
			}
			rs = ps.executeQuery();
			ResultSetMetaData rsmd = rs.getMetaData();
			int columnNum = rsmd.getColumnCount();
			while (rs.next()) {
				Object objects[] = new Object[columnNum];
				for (int i = 0; i < objects.length; i++) {
					objects[i] = rs.getObject(i + 1);
				}
				al.add(objects);
			}
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			dbu.close();
		}
		return al;
	}
}